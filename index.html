<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Quiz de Avalia√ß√£o - Descubra o n√≠vel de maturidade da sua cl√≠nica com a Dra. Andr√©a Melo">
    <meta name="theme-color" content="#0a0a0a">
    <meta property="og:title" content="Quiz Avalia√ß√£o | Dra. Andr√©a Melo">
    <meta property="og:description" content="Descubra o n√≠vel de maturidade da sua cl√≠nica">
    <meta property="og:type" content="website">
    <title>Quiz Avalia√ß√£o | Dra. Andr√©a Melo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Sora:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-card: #1a1a1a;
            --bg-input: #2a2a2a;
            --yellow-primary: #F5A623;
            --yellow-light: #FFD93D;
            --yellow-dark: #D4920A;
            --yellow-glow: rgba(245, 166, 35, 0.35);
            --text-primary: #ffffff;
            --text-secondary: #a3a3a3;
            --text-muted: #525252;
            --border-color: rgba(245, 166, 35, 0.25);
            --shadow-yellow: 0 0 50px rgba(245, 166, 35, 0.12);
            --gradient-yellow: linear-gradient(135deg, #F5A623 0%, #FFD93D 50%, #D4920A 100%);
            
            --rating-1: #EF4444;
            --rating-2: #EF4444;
            --rating-3: #F87171;
            --rating-4: #FB923C;
            --rating-5: #FB923C;
            --rating-6: #FBBF24;
            --rating-7: #F59E0B;
            --rating-8: #F59E0B;
            --rating-9: #22C55E;
            --rating-10: #16A34A;
            
            --color-red: #EF4444;
            --color-orange: #F59E0B;
            --color-green: #22C55E;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 20% 0%, rgba(245, 166, 35, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(212, 146, 10, 0.06) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        .logo-header {
            text-align: center;
            padding: 30px 0;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: 'Sora', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
        }

        .logo .new {
            font-size: 0.6rem;
            font-weight: 400;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--text-secondary);
            display: block;
            margin-bottom: -5px;
        }

        .logo .brand {
            color: var(--text-primary);
        }

        .logo .highlight {
            background: var(--gradient-yellow);
            color: var(--bg-primary);
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 800;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 35px 30px;
            box-shadow: var(--shadow-yellow);
            margin-bottom: 20px;
        }

        .card-title {
            font-family: 'Sora', sans-serif;
            font-size: 1.5rem;
            color: var(--yellow-primary);
            text-align: center;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .card-subtitle {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .card-subtitle strong {
            color: var(--text-primary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            background: var(--bg-input);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Outfit', sans-serif;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--yellow-primary);
            box-shadow: 0 0 0 4px rgba(245, 166, 35, 0.15);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .form-select {
            width: 100%;
            padding: 14px 18px;
            background: var(--bg-input);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Outfit', sans-serif;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23F5A623' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 18px;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--yellow-primary);
            box-shadow: 0 0 0 4px rgba(245, 166, 35, 0.15);
        }

        .form-select option {
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 10px;
        }

        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Outfit', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            width: 100%;
            background: var(--color-green);
            color: var(--text-primary);
            border: 2px solid var(--color-green);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #3B82F6;
            color: var(--text-primary);
            border: 2px solid #3B82F6;
        }

        .btn-secondary:hover {
            background: #2563EB;
            border-color: #2563EB;
        }

        .btn-outline {
            background: transparent;
            color: var(--text-secondary);
            border: 2px solid var(--border-color);
        }

        .btn-outline:hover {
            border-color: var(--yellow-primary);
            color: var(--yellow-primary);
        }

        .question-indicator {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .question-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .question-category {
            font-family: 'Sora', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .question-text {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 30px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.85); }
        }

        .rating-scale {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin: 25px 0;
        }

        .rating-btn {
            aspect-ratio: 1;
            min-height: 48px;
            border-radius: 10px;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 700;
            font-size: 1rem;
            color: var(--bg-primary);
            position: relative;
            overflow: hidden;
        }

        .rating-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .rating-btn.selected {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            z-index: 2;
        }

        .rating-btn.selected::after {
            content: '';
            position: absolute;
            inset: -3px;
            border: 3px solid var(--text-primary);
            border-radius: 12px;
        }

        .rating-btn[data-value="1"] { background: var(--rating-1); }
        .rating-btn[data-value="2"] { background: var(--rating-2); }
        .rating-btn[data-value="3"] { background: var(--rating-3); }
        .rating-btn[data-value="4"] { background: var(--rating-4); }
        .rating-btn[data-value="5"] { background: var(--rating-5); }
        .rating-btn[data-value="6"] { background: var(--rating-6); }
        .rating-btn[data-value="7"] { background: var(--rating-7); }
        .rating-btn[data-value="8"] { background: var(--rating-8); }
        .rating-btn[data-value="9"] { background: var(--rating-9); }
        .rating-btn[data-value="10"] { background: var(--rating-10); }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .nav-buttons .btn {
            flex: 1;
            padding: 14px 20px;
        }

        .mid-quiz-card {
            text-align: center;
        }

        .mid-quiz-title {
            font-family: 'Sora', sans-serif;
            font-size: 1.6rem;
            color: var(--text-primary);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .mid-quiz-text {
            color: var(--text-secondary);
            margin-bottom: 10px;
            line-height: 1.7;
        }

        .mid-quiz-note {
            font-size: 0.9rem;
            color: var(--yellow-primary);
            margin-bottom: 25px;
            font-weight: 500;
        }

        .calendar-container {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-month {
            font-family: 'Sora', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav button {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px 10px;
        }

        .calendar-nav button:hover {
            color: var(--yellow-primary);
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }

        .calendar-weekdays span {
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-primary);
            transition: all 0.2s ease;
            background: transparent;
            border: none;
        }

        .calendar-day:hover:not(.disabled):not(.selected) {
            background: rgba(245, 166, 35, 0.2);
        }

        .calendar-day.selected {
            background: #3B82F6;
            color: white;
            font-weight: 600;
        }

        .calendar-day.disabled {
            color: var(--text-muted);
            cursor: not-allowed;
        }

        .calendar-day.today {
            border: 2px solid var(--yellow-primary);
        }

        .time-select-container {
            margin-top: 20px;
        }

        .selected-date-display {
            background: var(--bg-input);
            border-radius: 12px;
            padding: 14px 18px;
            margin-bottom: 15px;
            text-align: center;
            color: var(--text-primary);
            font-weight: 500;
        }

        .results-alert {
            background: var(--color-red);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
            color: white;
        }

        .results-alert h3 {
            font-family: 'Sora', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .results-alert p {
            font-size: 0.95rem;
            line-height: 1.7;
            margin-bottom: 10px;
        }

        .results-score-card {
            text-align: center;
            margin-bottom: 30px;
        }

        .results-title {
            font-family: 'Sora', sans-serif;
            font-size: 1.3rem;
            color: var(--yellow-primary);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-circle {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100px;
            height: 100px;
            border-radius: 16px;
            font-family: 'Sora', sans-serif;
            font-size: 2.5rem;
            font-weight: 800;
            color: white;
            margin-bottom: 10px;
        }

        .score-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-box {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .chart-box h4 {
            font-family: 'Sora', sans-serif;
            font-size: 0.95rem;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
            text-align: center;
        }

        .chart-wrapper {
            position: relative;
            width: 100%;
            height: 200px;
        }

        .chart-wrapper canvas {
            width: 100% !important;
            height: 100% !important;
        }

        .nps-legend {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
        }

        .nps-legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .nps-legend-item .dot {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .nps-legend-item .dot.red { background: var(--color-red); }
        .nps-legend-item .dot.orange { background: var(--color-orange); }
        .nps-legend-item .dot.green { background: var(--color-green); }

        .cta-section {
            margin-top: 30px;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 15px 25px;
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 500;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast.success { border-color: var(--color-green); }
        .toast.error { border-color: var(--color-red); }

        @media (max-width: 600px) {
            .container { padding: 15px; }
            .card { padding: 25px 20px; }
            .rating-scale { grid-template-columns: repeat(5, 1fr); gap: 8px; }
            .rating-btn { min-height: 50px; font-size: 1.1rem; }
            .charts-grid { grid-template-columns: 1fr; }
            .nav-buttons { flex-direction: column; }
            .nav-buttons .btn { width: 100%; }
            .calendar-day { font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-header">
            <div class="logo">
                <div>
                    <span class="new">DRA.</span>
                    <span class="brand">ANDR√âA</span>
                </div>
                <span class="highlight">MELO</span>
            </div>
        </div>

        <!-- Section 1: Registration Form -->
        <div id="section-form" class="section active">
            <div class="card">
                <h2 class="card-title">Quiz - Avalia√ß√£o</h2>
                <p class="card-subtitle">
                    Preencha os dados abaixo para que possamos enviar seu diagn√≥stico com as notas e o gr√°fico da sua cl√≠nica.<br><br>
                    <strong>Fique tranquilo:</strong> seus dados s√£o utilizados exclusivamente para essa entrega.
                </p>

                <div class="form-group">
                    <label class="form-label">Nome</label>
                    <input type="text" class="form-input" id="userName" placeholder="Seu nome completo">
                </div>

                <div class="form-group">
                    <label class="form-label">E-mail</label>
                    <input type="email" class="form-input" id="userEmail" placeholder="seu@email.com">
                </div>

                <div class="form-group">
                    <label class="form-label">Telefone</label>
                    <input type="tel" class="form-input" id="userPhone" placeholder="(DDD) 99999-9999">
                </div>

                <div class="form-group">
                    <label class="form-label">Empresa ou Cl√≠nica</label>
                    <input type="text" class="form-input" id="userCompany" placeholder="Nome da sua cl√≠nica">
                </div>

                <div class="form-group">
                    <label class="form-label">Faturamento Mensal</label>
                    <select class="form-select" id="userRevenue">
                        <option value="">Selecione seu faturamento</option>
                        <option value="R$0 a R$10.000,00">R$0 a R$10.000,00</option>
                        <option value="R$10.000,00 a R$30.000,00">R$10.000,00 a R$30.000,00</option>
                        <option value="R$30.000,00 a R$50.000,00">R$30.000,00 a R$50.000,00</option>
                        <option value="R$50.000,00 a R$100.000,00">R$50.000,00 a R$100.000,00</option>
                        <option value="R$100.000,00 a R$300.000,00">R$100.000,00 a R$300.000,00</option>
                        <option value="Acima de R$300.000,00">Acima de R$300.000,00</option>
                    </select>
                </div>

                <button type="button" class="btn btn-primary" id="btnSubmitForm" onclick="submitForm()">Enviar</button>
            </div>
        </div>

        <!-- Section 2: Quiz Questions -->
        <div id="section-quiz" class="section">
            <div class="card">
                <h2 class="card-title">Quiz Avalia√ß√£o - Perguntas</h2>
                
                <div id="questionContainer">
                    <div class="question-indicator">
                        <span class="question-dot" id="questionDot"></span>
                        <span class="question-category" id="questionCategory">1. Qualidade de entrega</span>
                    </div>
                    
                    <p class="question-text" id="questionText"></p>

                    <div class="rating-scale" id="ratingScale"></div>

                    <div class="nav-buttons">
                        <button class="btn btn-secondary" id="btnBack" onclick="previousQuestion()">Voltar</button>
                        <button class="btn btn-outline" id="btnNext" onclick="nextQuestion()" disabled>Avan√ßar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 3: Mid-Quiz Scheduling -->
        <div id="section-midquiz" class="section">
            <div class="card mid-quiz-card">
                <h2 class="card-title">Quiz Avalia√ß√£o - Perguntas</h2>
                
                <h3 class="mid-quiz-title">Voc√™ chegou na metade do quiz</h3>
                
                <p class="mid-quiz-text">
                    <strong>Voc√™ ganhou uma reuni√£o de uma hora com o time</strong>, para com base no seu gargalo, montar um plano de a√ß√£o.
                </p>
                
                <p class="mid-quiz-note">
                    Esse √© um PR√â agendamento, nosso time vai entrar em contato para confirmar
                </p>

                <div class="form-group">
                    <label class="form-label">Escolha o dia</label>
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <span class="calendar-month" id="calendarMonth">fevereiro de 2026</span>
                            <div class="calendar-nav">
                                <button onclick="changeMonth(-1)">‚Äπ</button>
                                <button onclick="changeMonth(1)">‚Ä∫</button>
                            </div>
                        </div>
                        <div class="calendar-weekdays">
                            <span>DOM.</span>
                            <span>SEG.</span>
                            <span>TER.</span>
                            <span>QUA.</span>
                            <span>QUI.</span>
                            <span>SEX.</span>
                            <span>S√ÅB.</span>
                        </div>
                        <div class="calendar-days" id="calendarDays"></div>
                    </div>
                    <div class="selected-date-display" id="selectedDateDisplay">Selecione uma data</div>
                </div>

                <div class="form-group time-select-container">
                    <label class="form-label">Escolha o hor√°rio</label>
                    <select class="form-select" id="selectedTime">
                        <option value="">Selecione uma data primeiro</option>
                    </select>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="goBackToQuiz()">Voltar</button>
                    <button class="btn btn-primary" onclick="continueQuiz()" style="background: var(--color-green);">Continuar</button>
                </div>
            </div>
        </div>

        <!-- Section 4: Results -->
        <div id="section-results" class="section">
            <div class="logo-header">
                <div class="logo">
                    <div>
            </div>

            <div class="results-alert" id="resultsAlert">
                <h3>‚ö†Ô∏è Sua cl√≠nica est√° literalmente perdendo dinheiro todos os dias.</h3>
                <p>O diagn√≥stico mostrou que sua opera√ß√£o est√° no vermelho em √°reas vitais como precifica√ß√£o, marketing e vendas.</p>
                <p>Isso significa que voc√™ pode estar trabalhando muito... e lucrando pouco ‚Äî ou quase nada.</p>
            </div>

            <div class="card results-score-card">
                <h3 class="results-title">Sua Avalia√ß√£o</h3>
                <p class="score-label">M√©dia Geral -</p>
                <div class="score-circle" id="scoreCircle">0.0</div>
            </div>

            <div class="charts-grid">
                <div class="chart-box">
                    <h4>Desempenho por Categoria</h4>
                    <div class="chart-wrapper">
                        <canvas id="barChart"></canvas>
                    </div>
                </div>
                <div class="chart-box">
                    <h4>Distribui√ß√£o NPS</h4>
                    <div class="chart-wrapper" style="height: 150px;">
                        <canvas id="npsChart"></canvas>
                    </div>
                    <div class="nps-legend">
                        <div class="nps-legend-item"><span class="dot red"></span> Detratores</div>
                        <div class="nps-legend-item"><span class="dot orange"></span> Neutros</div>
                        <div class="nps-legend-item"><span class="dot green"></span> Promotores</div>
                    </div>
                </div>
            </div>

            <div class="cta-section">
                <a href="https://www.instagram.com/draandreamelo/" target="_blank" class="btn btn-primary" style="display: block; text-align: center; text-decoration: none;">
                    Agendar minha sess√£o agora
                </a>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // ============================================
        // CONFIGURA√á√ÉO DO WEBHOOK
        // ============================================
        const WEBHOOK_URL = 'https://script.google.com/macros/s/AKfycbzqAZEr4HFBaZrpNSAXweQGqmADYvSiZ_aor2GATkJvruXLZkUF_JVsthufMTbtTpsN/exec';
        
        // ============================================
        // Quiz Data
        // ============================================
        const categories = [
            { id: 1, name: "Qualidade de entrega", color: "#F59E0B", question: "Voc√™ sente que a experi√™ncia que o paciente vive hoje na sua cl√≠nica √© memor√°vel e o encanta a ponto de gerar fechar o tratamento e gerar indica√ß√£o espont√¢nea?" },
            { id: 2, name: "Planejamento estrat√©gico", color: "#F59E0B", question: "Sua cl√≠nica tem um plano claro e documentado para os pr√≥ximos 6 a 12 meses, com metas e a√ß√µes definidas?" },
            { id: 3, name: "Precifica√ß√£o", color: "#22C55E", question: "Voc√™ tem total clareza de quanto custa cada procedimento e consegue precificar com base em lucro real?" },
            { id: 4, name: "Financeiro", color: "#3B82F6", question: "Voc√™ sabe, com exatid√£o, qual √© o faturamento e a lucratividade da sua cl√≠nica hoje e quanto poderia estar ganhando com uma gest√£o financeira mais precisa?" },
            { id: 5, name: "Marketing interno", color: "#06B6D4", question: "Os pacientes que j√° frequentam sua cl√≠nica s√£o engajados e impactados por meio de a√ß√µes internas bem pensadas?" },
            { id: 6, name: "Estrutura f√≠sica", color: "#EF4444", question: "Sua estrutura f√≠sica est√° √† altura do posicionamento que voc√™ quer transmitir ao seu p√∫blico-alvo?" },
            { id: 7, name: "Segmenta√ß√£o de agenda", color: "#EF4444", question: "Sua agenda est√° organizada por tipo de paciente, com prioridade para atendimentos de maior valor e retorno estrat√©gico?" },
            { id: 8, name: "Protocolo de venda", color: "#F59E0B", question: "Voc√™ ou sua equipe seguem um passo a passo estruturado para apresentar o plano de tratamento e fechar vendas com confian√ßa?" },
            { id: 9, name: "Equipe", color: "#F59E0B", question: "Sua equipe est√° alinhada, treinada e engajada com os resultados da cl√≠nica, sabendo exatamente como contribuir para o crescimento da sua cl√≠nica?" },
            { id: 10, name: "Marketing externo", color: "#22C55E", question: "Sua cl√≠nica tem uma estrat√©gia de capta√ß√£o de pacientes nova e recorrente, com previsibilidade e retorno claro sobre os investimentos?" }
        ];

        let currentQuestion = 0;
        let answers = {};
        let userData = {};
        let selectedDate = null;
        let currentMonth = new Date();
        let barChartInstance = null;
        let npsChartInstance = null;

        // ============================================
        // Toast Notification
        // ============================================
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast ' + type + ' show';
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        // ============================================
        // Form Submission
        // ============================================
        function submitForm() {
            const name = document.getElementById('userName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            const phone = document.getElementById('userPhone').value.trim();
            const company = document.getElementById('userCompany').value.trim();
            const revenue = document.getElementById('userRevenue').value;

            if (!name) { showToast('Por favor, preencha seu nome', 'error'); document.getElementById('userName').focus(); return; }
            if (!email || !email.includes('@')) { showToast('Por favor, preencha um e-mail v√°lido', 'error'); document.getElementById('userEmail').focus(); return; }
            if (!phone || phone.length < 14) { showToast('Por favor, preencha um telefone v√°lido', 'error'); document.getElementById('userPhone').focus(); return; }
            if (!revenue) { showToast('Por favor, selecione seu faturamento', 'error'); document.getElementById('userRevenue').focus(); return; }

            userData = { name, email, phone, company, revenue, timestamp: new Date().toISOString() };
            console.log('Dados do usu√°rio:', userData);

            showSection('section-quiz');
            initRatingButtons();
            displayQuestion();
        }

        // ============================================
        // Send Data to Webhook
        // ============================================
        async function sendToWebhook(data) {
            if (!WEBHOOK_URL) { console.log('Webhook n√£o configurado. Dados:', data); return true; }
            try {
                await fetch(WEBHOOK_URL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                console.log('Dados enviados com sucesso para o Google Sheets');
                return true;
            } catch (error) {
                console.error('Erro ao enviar dados:', error);
                return false;
            }
        }

        // ============================================
        // Rating Buttons
        // ============================================
        function initRatingButtons() {
            const container = document.getElementById('ratingScale');
            container.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                const btn = document.createElement('button');
                btn.className = 'rating-btn';
                btn.setAttribute('data-value', i);
                btn.textContent = i;
                btn.onclick = () => selectRating(i);
                container.appendChild(btn);
            }
        }

        function selectRating(value) {
            answers[currentQuestion] = value;
            document.querySelectorAll('.rating-btn').forEach(btn => {
                btn.classList.remove('selected');
                if (parseInt(btn.getAttribute('data-value')) === value) btn.classList.add('selected');
            });
            const btnNext = document.getElementById('btnNext');
            btnNext.disabled = false;
            btnNext.classList.remove('btn-outline');
            btnNext.classList.add('btn-primary');
            btnNext.style.background = 'var(--color-green)';
        }

        function displayQuestion() {
            const category = categories[currentQuestion];
            document.getElementById('questionCategory').textContent = `${category.id}. ${category.name}`;
            document.getElementById('questionText').textContent = category.question;
            document.getElementById('questionDot').style.background = category.color;
            document.getElementById('btnBack').style.visibility = currentQuestion === 0 ? 'hidden' : 'visible';
            document.getElementById('btnNext').textContent = currentQuestion === categories.length - 1 ? 'Finalizar' : 'Avan√ßar';
            
            document.querySelectorAll('.rating-btn').forEach(btn => btn.classList.remove('selected'));
            const btnNext = document.getElementById('btnNext');
            if (answers[currentQuestion]) {
                document.querySelector(`.rating-btn[data-value="${answers[currentQuestion]}"]`).classList.add('selected');
                btnNext.disabled = false;
                btnNext.style.background = 'var(--color-green)';
            } else {
                btnNext.disabled = true;
                btnNext.classList.remove('btn-primary');
                btnNext.classList.add('btn-outline');
                btnNext.style.background = '';
            }
        }

        function nextQuestion() {
            if (!answers[currentQuestion]) return;
            if (currentQuestion === 4) { showSection('section-midquiz'); initCalendar(); return; }
            if (currentQuestion < categories.length - 1) { currentQuestion++; displayQuestion(); }
            else { showResults(); }
        }

        function previousQuestion() {
            if (currentQuestion > 0) { currentQuestion--; displayQuestion(); }
        }

        function goBackToQuiz() { showSection('section-quiz'); }

        function continueQuiz() {
            userData.scheduledDate = selectedDate ? selectedDate.toISOString().split('T')[0] : '';
            userData.scheduledTime = document.getElementById('selectedTime').value || '';
            currentQuestion++;
            showSection('section-quiz');
            displayQuestion();
        }

        // ============================================
        // Calendar
        // ============================================
        function initCalendar() { renderCalendar(); }

        function renderCalendar() {
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            const monthNames = ['janeiro', 'fevereiro', 'mar√ßo', 'abril', 'maio', 'junho', 'julho', 'agosto', 'setembro', 'outubro', 'novembro', 'dezembro'];
            document.getElementById('calendarMonth').innerHTML = `${monthNames[month]} de ${year} <span class="arrow">‚Ä∫</span>`;
            
            const container = document.getElementById('calendarDays');
            container.innerHTML = '';
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date(); today.setHours(0, 0, 0, 0);

            for (let i = 0; i < firstDay; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day disabled';
                container.appendChild(emptyDiv);
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dayBtn = document.createElement('button');
                dayBtn.className = 'calendar-day';
                dayBtn.textContent = day;
                const currentDate = new Date(year, month, day);
                const dayOfWeek = currentDate.getDay();

                if (dayOfWeek === 0 || dayOfWeek === 6 || currentDate < today) {
                    dayBtn.classList.add('disabled');
                } else {
                    dayBtn.onclick = () => selectDateFn(year, month, day);
                }

                if (day === today.getDate() && month === today.getMonth() && year === today.getFullYear()) dayBtn.classList.add('today');
                if (selectedDate && day === selectedDate.getDate() && month === selectedDate.getMonth() && year === selectedDate.getFullYear()) dayBtn.classList.add('selected');
                container.appendChild(dayBtn);
            }
        }

        function changeMonth(delta) { currentMonth.setMonth(currentMonth.getMonth() + delta); renderCalendar(); }

        function selectDateFn(year, month, day) {
            selectedDate = new Date(year, month, day);
            const monthNames = ['jan', 'fev', 'mar', 'abr', 'mai', 'jun', 'jul', 'ago', 'set', 'out', 'nov', 'dez'];
            document.getElementById('selectedDateDisplay').textContent = `${day} de ${monthNames[month]}. de ${year}`;
            document.getElementById('selectedTime').innerHTML = `
                <option value="">Selecione um hor√°rio</option>
                <option value="09:00">09:00</option>
                <option value="10:00">10:00</option>
                <option value="11:00">11:00</option>
                <option value="12:00">12:00</option>
                <option value="13:00">13:00</option>
                <option value="14:00">14:00</option>
                <option value="15:00">15:00</option>
                <option value="16:00">16:00</option>
            `;
            renderCalendar();
        }

        // ============================================
        // Results
        // ============================================
        async function showResults() {
            showSection('section-results');
            
            const values = Object.values(answers);
            const average = values.reduce((a, b) => a + b, 0) / values.length;

            const answersByCategory = {};
            categories.forEach((cat, index) => { answersByCategory[cat.name] = answers[index] || 0; });

            const completeData = { ...userData, answers: answersByCategory, average: average.toFixed(1), completedAt: new Date().toISOString() };
            console.log('Dados completos:', completeData);
            await sendToWebhook(completeData);

            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.textContent = average.toFixed(1);
            scoreCircle.style.background = average <= 4 ? 'var(--color-red)' : average <= 6 ? 'var(--color-orange)' : 'var(--color-green)';

            const alertDiv = document.getElementById('resultsAlert');
            if (average >= 7) {
                alertDiv.style.background = 'var(--color-green)';
                alertDiv.innerHTML = `<h3>üéâ Parab√©ns! Sua cl√≠nica est√° no caminho certo.</h3><p>O diagn√≥stico mostrou que voc√™ tem uma boa estrutura em √°reas importantes.</p><p>Mas sempre h√° espa√ßo para melhorar e escalar seus resultados!</p>`;
            } else if (average >= 5) {
                alertDiv.style.background = 'var(--color-orange)';
                alertDiv.innerHTML = `<h3>‚ö†Ô∏è Sua cl√≠nica precisa de aten√ß√£o em algumas √°reas.</h3><p>O diagn√≥stico mostrou que existem oportunidades de melhoria em √°reas importantes.</p><p>Com os ajustes certos, voc√™ pode destravar seus resultados rapidamente.</p>`;
            }

            setTimeout(() => {
                createBarChart();
                createNPSChart();
            }, 100);
        }

        // ============================================
        // Charts
        // ============================================
        function createBarChart() {
            const canvas = document.getElementById('barChart');
            if (!canvas) { console.error('Canvas barChart n√£o encontrado'); return; }
            if (barChartInstance) { barChartInstance.destroy(); }

            const ctx = canvas.getContext('2d');
            const labels = categories.map(c => c.name.split(' ')[0].substring(0, 8));
            const data = categories.map((c, i) => answers[i] || 0);
            const colors = data.map(v => v <= 4 ? '#EF4444' : v <= 6 ? '#F59E0B' : '#22C55E');
            
            barChartInstance = new Chart(ctx, {
                type: 'bar',
                data: { labels: labels, datasets: [{ data: data, backgroundColor: colors, borderRadius: 4, barThickness: 18 }] },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, max: 10, ticks: { color: '#525252', stepSize: 2, font: { size: 10 } }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        x: { ticks: { color: '#525252', font: { size: 7 }, maxRotation: 45, minRotation: 45 }, grid: { display: false } }
                    }
                }
            });
        }

        function createNPSChart() {
            const canvas = document.getElementById('npsChart');
            if (!canvas) { console.error('Canvas npsChart n√£o encontrado'); return; }
            if (npsChartInstance) { npsChartInstance.destroy(); }

            const ctx = canvas.getContext('2d');
            const values = Object.values(answers);
            const detractors = values.filter(v => v <= 4).length;
            const passives = values.filter(v => v > 4 && v <= 6).length;
            const promoters = values.filter(v => v > 6).length;
            
            npsChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['Detratores', 'Neutros', 'Promotores'], datasets: [{ data: [detractors, passives, promoters], backgroundColor: ['#EF4444', '#F59E0B', '#22C55E'], borderWidth: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { display: false } } }
            });
        }

        // ============================================
        // Section Navigation
        // ============================================
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ============================================
        // Phone Mask
        // ============================================
        document.getElementById('userPhone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 11) value = value.slice(0, 11);
            if (value.length > 0) value = '(' + value;
            if (value.length > 3) value = value.slice(0, 3) + ') ' + value.slice(3);
            if (value.length > 10) value = value.slice(0, 10) + '-' + value.slice(10);
            e.target.value = value;
        });

        // ============================================
        // Keyboard Navigation
        // ============================================
        document.addEventListener('keydown', function(e) {
            const quizSection = document.getElementById('section-quiz');
            if (!quizSection.classList.contains('active')) return;
            if (e.key >= '1' && e.key <= '9') selectRating(parseInt(e.key));
            else if (e.key === '0') selectRating(10);
            else if (e.key === 'Enter' && !document.getElementById('btnNext').disabled) nextQuestion();
            else if (e.key === 'ArrowLeft' && currentQuestion > 0) previousQuestion();
        });

        document.querySelectorAll('#section-form .form-input, #section-form .form-select').forEach(input => {
            input.addEventListener('keydown', function(e) { if (e.key === 'Enter') { e.preventDefault(); submitForm(); } });
        });
    </script>
</body>
</html>
